% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em_algorithm.R
\name{fit_cthoubv}
\alias{fit_cthoubv}
\title{Fit a Continuous-Time Hidden OU Model with Bounded Variation}
\usage{
fit_cthoubv(
  deltaY,
  time,
  h,
  trans_init,
  gamma0_init,
  gamma1_init,
  phi0_init,
  sigma_s,
  dt,
  max_iter = 50,
  tol = 1e-04
)
}
\arguments{
\item{deltaY}{Numeric vector of observed increments \eqn{\Delta Y_{t_n}}.}

\item{time}{Numeric vector of observation times \eqn{t_n}.}

\item{sigma_s}{Observation noise volatility.}

\item{dt}{Numeric vector of time increments \eqn{\Delta_n}.}

\item{max_iter}{Maximum number of EM iterations.}

\item{tol}{Convergence tolerance for the negative log-likelihood.}

\item{M}{Numeric vector of observed process \eqn{M_{t_n}}.}

\item{mu}{Numeric vector of deterministic drift \eqn{\mu_{t_n}}.}

\item{Q_init}{Initial generator matrix for the hidden Markov chain.}

\item{m_init}{Initial emission means for the hidden states.}

\item{a}{Numeric vector of OU drift parameters \eqn{a_i}.}

\item{gamma_init}{Initial values for mean-reversion parameters
\eqn{(\gamma_0, \gamma_1)}.}

\item{phi0}{Initial value of the bounded-variation process.}
}
\value{
A list containing:
\describe{
\item{gamma}{Estimated mean-reversion parameters.}
\item{phi}{Estimated bounded-variation process.}
\item{p}{Filtered state probabilities.}
\item{Q}{Estimated generator matrix.}
}
}
\description{
Fits a continuous-time hidden Markov model with OU-type bounded
variation dynamics using an EM-style iterative procedure.
The latent Markov chain is estimated in continuous time, and
the bounded-variation process is inferred using filtered
state probabilities.
}
\details{
The algorithm alternates between:
\enumerate{
\item Estimating the continuous-time hidden Markov chain using
a Gaussian emission model.
\item Updating the bounded-variation process and optimizing
OU parameters via likelihood maximization.
}
}
\examples{
\dontrun{
fit <- fit_cthoubv(deltaY, time, dt, M, mu,
                     Q_init, m_init, a,
                     gamma_init, phi0, sigma_s)
}

}
\references{
Baum, L. E., et al. (1970). A maximization technique occurring in
the statistical analysis of probabilistic functions of Markov chains.
}
\seealso{
\code{\link{step1_cthmm}}, \code{\link{compute_phi}}
}
